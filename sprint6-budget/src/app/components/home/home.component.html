<app-welcome></app-welcome>

@for ( product of products; track $index) {
<div class="container-lg services">
    <div class="container d-flex align-items-center justify-content-between px-5">
        <div>
            <h3>{{product.title}}</h3>
            <p>{{product.description}}</p>
        </div>
        <div>
            <p class="font-24">{{product.price}}<span class="font-16">€</span></p>
        </div>
        <form class="form-check" [formGroup]="serviciosForm">
            <input class="form-check-input" type="checkbox" value="" (change)="updateCost()"
                formControlName="checkbox{{$index}}">
            <label class="form-check-label font-14" >
                Afegir
            </label>
       
        </form>
       
        <!-- {{formChecked.value | json}} -->
    </div>
    <div class="container-lg services-invalid">
 @if(submitted && total === 0) {
        <p class="px-5" [class.invalid]="total === 0" class="invalid px-5">Heu de triar com a mínim un servei!</p>
        }
    </div >
   
    @if(isChecked && products[$index].title === 'Web') {
    <app-panel [serviciosParentForm]="serviciosForm"></app-panel>
    }

   
</div>
}



<div class="container-lg services-preu">
    <div class="container  d-flex  justify-content-end align-items-center px-5">
        <h3 class="services-preu--heading">Preu pressuposat:</h3>
        <p class="services-preu--number"><span>{{total}}</span>€</p>
    </div>
</div>

<div class="container-lg contact d-flex align-items-center flex-column services-contact">
    <div class="text-start px-5 container-lg">
        <h3>Demanar pressupost</h3>
    </div>
    <form [formGroup]="serviciosForm"
        class="container-lg px-5 d-flex align-items-center justify-content-between gap-2 form-contact">
        <div class="">
            <input type="text" class="form-control" id="nom" placeholder="Nom" formControlName="name">
            @if(serviciosForm.get('name')?.errors?.['required'] && serviciosForm.get('name')?.touched) {
            <p class="contact-invalid input-validation" [class.visibility]="!serviciosForm.valid">Nombre és necesari</p>
            }
            @if(submitted) {
                <p class="contact-invalid input-validation">Nombrel és necesari</p>
            }
        </div>
        <div class="">
            <input type="tel" class="form-control" id="telephone" placeholder="Teléfon" formControlName="telephone">
            @if(serviciosForm.get('telephone')?.errors?.['required'] && serviciosForm.get('telephone')?.touched || serviciosForm.get('telephone')?.errors?.['telephoneInvalid'] && serviciosForm.get('telephone')?.touched) {
            <p class="contact-invalid">Número de telèfon necessari</p>
            }
            @if(submitted) {
                <p class="contact-invalid input-validation">Número de teèfon és necesari</p>
            }
        </div>
        <div class="">
            <input type="email" class="form-control" id="email" placeholder="Email" formControlName="email">
            <!-- @if(serviciosForm.get('email')?.errors?.['required'] && serviciosForm.get('email')?.touched) {
            <p class="contact-invalid ">L'Email és necessari</p>
            } -->
            @if(serviciosForm.get('email')?.errors?.['required'] && serviciosForm.get('email')?.touched ||
            serviciosForm.get('email')?.errors?.['emailInvalid']
            && serviciosForm.get('email')?.touched) {
            <p class="contact-invalid input-validation">L'Email no és vàlid</p>
            }
            @if(submitted) {
                <p class="contact-invalid input-validation">L'Email és necesari</p>
            }
        </div>
        <button (click)="onSubmit()"  type="submit"
            class="btn btn-primary contact-btn">Sol-licitar pressupost <fa-icon [icon]="faArrowRight"
                class="contact-icon"></fa-icon></button>
    </form>
    <!-- @if((submitted && serviciosForm.get('name')?.value === "") || (submitted && serviciosForm.get('email')?.value ===
    "")|| (submitted && serviciosForm.get('telephone')?.value === "")) {
    <p class="contact-invalid">Si us plau completa els camps necessaris...</p>
    } -->
</div>


@if(clients.length > 0) {

<app-budget [clients]="clients"></app-budget>
}